/*! ThinkTank 2013-11-13 */
var thinkTank=thinkTank||{};thinkTank.db={checkForSupport:function(){return"indexedDB"in window},database:!1,open:function(a){if(!this.checkForSupport)return console.warn("IndexedDB is not supported!"),void 0;var b=new Event("dbConnected"),c=indexedDB.open(a.dbName,a.dbVersion),d=this;c.onupgradeneeded=function(b){var c=b.target.result;c.objectStoreNames.contains(a.objStoreName)||c.createObjectStore(a.objStoreName,{autoIncrement:!0})},c.onsuccess=function(c){return console.log("Db connected."),d.database=c.target.result,document.dispatchEvent(b),a.callbackOnSuccess?a.callbackOnSuccess(c):!1},c.onerror=function(b){console.log("Error :",b),a.callbackOnError&&a.callbackOnError(b)}},add:function(a){var b=this,c=function(){var c=b.database.transaction([a.objStoreName],"readwrite"),d=c.objectStore(a.objStoreName),e=d.add(a.data);e.onerror=function(b){return console.warn("Error",b.target.error.name),a.callbackOnError?a.callbackOnError(b):!1},e.onsuccess=function(b){return a.callbackOnSuccess?a.callbackOnSuccess(b):!1}};this.database?c():document.addEventListener("dbConnected",c,!1)},"delete":function(a){var b=this,c=function(){var c=b.database.transaction([a.objStoreName],"readwrite"),d=c.objectStore(a.objStoreName),e=d.delete(parseInt(a.id));e.onsuccess=function(b){return a.callbackOnSuccess?a.callbackOnSuccess(b):!1}};this.database?c():document.addEventListener("dbConnected",c,!1)},get:function(a){var b=this,c=[],d=function(d){var e=b.database.transaction([a.objStoreName],"readonly"),f=e.objectStore(a.objStoreName),g=f.openCursor();g.onerror=function(){return console.warn("Error",d.target.error.name),a.callbackOnError?a.callbackOnError(d):!1},g.onsuccess=function(b){var d=b.target.result;return 0==!!d?a.callbackOnSuccess?a.callbackOnSuccess(c):!1:(d.value.id=d.key,c.push(d.value),d.continue(),void 0)}};this.database?d():document.addEventListener("dbConnected",d,!1)},clear:function(a){var b=this,c=function(){var c=b.database.transaction([a.objStoreName],"readwrite"),d=c.objectStore(a.objStoreName),e=d.clear();e.onsuccess=function(b){return console.log("objectStore ",a.objStoreName," is cleared."),a.callbackOnSuccess?a.callbackOnSuccess(b):!1}};this.database?c():document.addEventListener("dbConnected",c,!1)}};var Handlebars={};!function(Handlebars,a){Handlebars.VERSION="1.0.0",Handlebars.COMPILER_REVISION=4,Handlebars.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},Handlebars.helpers={},Handlebars.partials={};var b=Object.prototype.toString,c="[object Function]",d="[object Object]";Handlebars.registerHelper=function(a,c,e){if(b.call(a)===d){if(e||c)throw new Handlebars.Exception("Arg not supported with multiple helpers");Handlebars.Utils.extend(this.helpers,a)}else e&&(c.not=e),this.helpers[a]=c},Handlebars.registerPartial=function(a,c){b.call(a)===d?Handlebars.Utils.extend(this.partials,a):this.partials[a]=c},Handlebars.registerHelper("helperMissing",function(b){if(2===arguments.length)return a;throw new Error("Missing helper: '"+b+"'")}),Handlebars.registerHelper("blockHelperMissing",function(a,d){var e=d.inverse||function(){},f=d.fn,g=b.call(a);return g===c&&(a=a.call(this)),a===!0?f(this):a===!1||null==a?e(this):"[object Array]"===g?a.length>0?Handlebars.helpers.each(a,d):e(this):f(a)}),Handlebars.K=function(){},Handlebars.createFrame=Object.create||function(a){Handlebars.K.prototype=a;var b=new Handlebars.K;return Handlebars.K.prototype=null,b},Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(a,b){if(Handlebars.logger.level<=a){var c=Handlebars.logger.methodMap[a];"undefined"!=typeof console&&console[c]&&console[c].call(console,b)}}},Handlebars.log=function(a,b){Handlebars.logger.log(a,b)},Handlebars.registerHelper("each",function(a,d){var e,f=d.fn,g=d.inverse,h=0,i="",j=b.call(a);if(j===c&&(a=a.call(this)),d.data&&(e=Handlebars.createFrame(d.data)),a&&"object"==typeof a)if(a instanceof Array)for(var k=a.length;k>h;h++)e&&(e.index=h),i+=f(a[h],{data:e});else for(var l in a)a.hasOwnProperty(l)&&(e&&(e.key=l),i+=f(a[l],{data:e}),h++);return 0===h&&(i=g(this)),i}),Handlebars.registerHelper("if",function(a,d){var e=b.call(a);return e===c&&(a=a.call(this)),!a||Handlebars.Utils.isEmpty(a)?d.inverse(this):d.fn(this)}),Handlebars.registerHelper("unless",function(a,b){return Handlebars.helpers["if"].call(this,a,{fn:b.inverse,inverse:b.fn})}),Handlebars.registerHelper("with",function(a,d){var e=b.call(a);return e===c&&(a=a.call(this)),Handlebars.Utils.isEmpty(a)?void 0:d.fn(a)}),Handlebars.registerHelper("log",function(a,b){var c=b.data&&null!=b.data.level?parseInt(b.data.level,10):1;Handlebars.log(c,a)});var e=["description","fileName","lineNumber","message","name","number","stack"];Handlebars.Exception=function(){for(var a=Error.prototype.constructor.apply(this,arguments),b=0;b<e.length;b++)this[e[b]]=a[e[b]]},Handlebars.Exception.prototype=new Error,Handlebars.SafeString=function(a){this.string=a},Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},g=/[&<>"'`]/g,h=/[&<>"'`]/,i=function(a){return f[a]||"&amp;"};Handlebars.Utils={extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},escapeExpression:function(a){return a instanceof Handlebars.SafeString?a.toString():null==a||a===!1?"":(a=a.toString(),h.test(a)?a.replace(g,i):a)},isEmpty:function(a){return a||0===a?"[object Array]"===b.call(a)&&0===a.length?!0:!1:!0}},Handlebars.VM={template:function(a){var b={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=Handlebars.VM.program(a,b,c):d||(d=this.programs[a]=Handlebars.VM.program(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&(c={},Handlebars.Utils.extend(c,b),Handlebars.Utils.extend(c,a)),c},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop,compilerInfo:null};return function(c,d){d=d||{};var e=a.call(b,Handlebars,c,d.helpers,d.partials,d.data),f=b.compilerInfo||[],g=f[0]||1,h=Handlebars.COMPILER_REVISION;if(g!==h){if(h>g){var i=Handlebars.REVISION_CHANGES[h],j=Handlebars.REVISION_CHANGES[g];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+j+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+f[1]+")."}return e}},programWithDepth:function(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e},program:function(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d},noop:function(){return""},invokePartial:function(b,c,d,e,f,g){var h={helpers:e,partials:f,data:g};if(b===a)throw new Handlebars.Exception("The partial "+c+" could not be found");if(b instanceof Function)return b(d,h);if(Handlebars.compile)return f[c]=Handlebars.compile(b,{data:g!==a}),f[c](d,h);throw new Handlebars.Exception("The partial "+c+" could not be compiled when running in runtime-only mode")}},Handlebars.template=Handlebars.VM.template}(Handlebars);var thinkTank=thinkTank||{};thinkTank.wr=function(){"use strict";function a(a){if(a){var b=this,c="string"==typeof a?document.querySelectorAll(a):a;c.length&&c.length>0?!function(a){var c=b.length||0;for(var d in a)1==a[d].nodeType&&(b[c++]=a[d]);return b.length=c,this}(c):c.nodeType&&1==c.nodeType&&!function(a){var c=b.length||0;return b[c++]=a,b.length=c,this}(c)}}function b(b){return new a(b)}return b.NodeList=a,a.prototype.each=function(a){for(var b=-1,c=this.length;++b<c;)a.call(this[b],b,c,this)},b}();var thinkTank=thinkTank||{};thinkTank.Expenses=function(a){"use strict";function b(a,b,c){switch(c){case f.classBtnAdd:e.addListElem();break;case f.classBtnRemove:e.removeListElem(a,b)}console.log("Click : ",b,c)}var c,d,e=this,f={target:!1,classActive:"open",classBtnRemove:"btn-expenses-remove",classHeader:"expenses-header",classPluginContainer:"expenses",classBtnAdd:"btn-expenses-add",templateMain:"expenses",templateListSingleEl:"expenses-list-single",selectorAddContainer:".expenses-dd-block-action-add",selectorList:".expenses-dd-list table",selectorPriceInput:".expenses-price"},g=[{name:"breakfast",price:13},{name:"Pizza",price:5},{name:"Lunch",price:20},{name:"Coffee",price:2},{name:"Dinner",price:32}];thinkTank.wr().extend(f,a),c=[f.classHeader,f.classBtnRemove,f.classBtnAdd],this.addListElem=function(){if(d){var a=d.querySelectorAll(f.selectorAddContainer+" input[name]"),b={};for(var c in a)1==a[c].nodeType&&(a[c].getAttribute("name").indexOf("name")>0?b.name=a[c].value:b.price=a[c].value);b.name&&b.price?thinkTank.db.add({objStoreName:"expenses2",data:b,callbackOnSuccess:function(a){var c;b.id=a.target.result,c=thinkTank.JST[f.templateListSingleEl](b),d.querySelector(f.selectorList).insertAdjacentHTML("beforeend",c)},callbackOnError:function(a){console.warn("Error: ",a)}}):thinkTank.Notification.show("Please fill in all fields",{icon:"img/notification.png"})}},this.removeListElem=function(a,b){var c=b.getAttribute("data-id");thinkTank.db.delete({objStoreName:"expenses2",id:c,callbackOnSuccess:function(){thinkTank.wr(b).closest("tr",function(a){a.parentNode.removeChild(a)})}})},this.init=function(a,e){var h=document.createElement("div"),e=e||g;h.innerHTML=thinkTank.JST[f.templateMain]({id:a.getAttribute("id"),list:e}),d=h.firstChild,document.body.replaceChild(d,a),d.onclick=function(a){for(var d=a.target;d;){for(var e in c)if(d.classList.contains(c[e])){b(a,d,c[e]),d=!1;break}d=0==d||d.classList.contains(f.classPluginContainer)?!1:d.parentNode}},d.querySelector(f.selectorPriceInput).onkeypress=function(a){var b=a||window.event,c=b.keyCode||b.which,d=/[0-9]|\./;c=String.fromCharCode(c),d.test(c)||(b.returnValue=!1,b.preventDefault&&b.preventDefault())}}};var thinkTank=thinkTank||{};thinkTank.Notification={checkPermission:function(a){window.Notification&&Notification.requestPermission(function(b){"granted"===b&&a()})},show:function(a,b){this.checkPermission(function(){new Notification(a,b)})}},this.thinkTank=this.thinkTank||{},this.thinkTank.JST=this.thinkTank.JST||{},this.thinkTank.JST["expenses-list-single"]=Handlebars.template(function(Handlebars,a,b,c,d){function e(a,c){var d,e="";return e+="\n  <tr>\n    <td>",(d=b.name)?d=d.call(a,{hash:{},data:c}):(d=a.name,d=typeof d===h?d.apply(a):d),e+=i(d)+"</td>\n    <td>\n      ",(d=b.price)?d=d.call(a,{hash:{},data:c}):(d=a.price,d=typeof d===h?d.apply(a):d),e+=i(d)+'\n      <a href="javascript:void(0)" class="btn-expenses-remove" data-id="',(d=b.id)?d=d.call(a,{hash:{},data:c}):(d=a.id,d=typeof d===h?d.apply(a):d),e+=i(d)+'">&times;</a>\n    </td>\n  </tr>\n'}function f(){return"\n  <tr>\n    <td>&nbsp;</td>\n    <td>&nbsp;</td>\n  </tr>\n"}this.compilerInfo=[4,">= 1.0.0"],b=this.merge(b,Handlebars.helpers),d=d||{};var g,h="function",i=this.escapeExpression,j=this;return g=b["if"].call(a,a.name,{hash:{},inverse:j.program(3,f,d),fn:j.program(1,e,d),data:d}),g||0===g?g:""}),this.thinkTank.JST.expenses=Handlebars.template(function(Handlebars,a,b,c,d){function e(a,d){var e,f="";return f+="\n          ",e=h.invokePartial(c["expenses-list-single"],"expenses-list-single",a,b,c,d),(e||0===e)&&(f+=e),f+="\n        "}this.compilerInfo=[4,">= 1.0.0"],b=this.merge(b,Handlebars.helpers),c=this.merge(c,Handlebars.partials),d=d||{};var f,g="",h=this,i="function",j=this.escapeExpression;return g+='<div class="expenses open" id="',(f=b.id)?f=f.call(a,{hash:{},data:d}):(f=a.id,f=typeof f===i?f.apply(a):f),g+=j(f)+'">\n  <header class="expenses-header">Expenses</header>\n  <div class="expenses-dd">\n    <table class="expenses-dd-header">\n      <tr>\n        <th>Name <i class="icon-caret-down"></i></th>\n        <th>Amount</th>\n      </tr>\n    </table>\n    <div class="expenses-dd-list" data-list-rows="5">\n      <table>\n        ',f=b.each.call(a,a.list,{hash:{},inverse:h.noop,fn:h.program(1,e,d),data:d}),(f||0===f)&&(g+=f),g+='\n      </table>\n    </div>\n    <table class="expenses-dd-block-action-add">\n      <tr>\n        <td>\n          <input type="text" name="expenses-name">\n        </td>\n        <td class="no-wrap">\n          $\n          <input type="text" class="expenses-price" name="expenses-price" pattern="\\d*">\n          <a href="#" class="btn-expenses-add">\n            <i class="icon-plus"></i>\n          </a>\n        </td>\n      </tr>\n    </table>\n  </div>\n</div>'}),Handlebars.registerPartial("expenses-list-single",thinkTank.JST["expenses-list-single"]),thinkTank.wr.NodeList.prototype.extend=function(a,b){if(b)for(var c in b)a[c]=b[c];return a},thinkTank.wr.NodeList.prototype.expenses=function(a){this.each(function(){new thinkTank.Expenses(a).init(this,a.data||!1)})},thinkTank.wr.NodeList.prototype.closest=function(a,b){return this.each(function(){for(var c=this;c&&!c.classList.contains(a.replace(".",""))&&c.tagName.toLowerCase()!=a&&c.getAttribute("id")!=a.replace("#","");)c=c.parentNode;b(c)})},document.addEventListener("DOMContentLoaded",function(){thinkTank.db.open({dbName:"expensesDb2",dbVersion:2,objStoreName:"expenses2"}),thinkTank.db.get({objStoreName:"expenses2",callbackOnSuccess:function(a){thinkTank.wr(".js-expense").expenses({data:a})}})},!1);
//# sourceMappingURL=app/js/main-map.js.map